{
  "version": "1.0",
  "type": "layout",
  "imports": {
    "config": "../data/config.json",
    "nav": "../data/navigation.json"
  },
  "params": {
    "navigation": { "type": "json", "required": true },
    "currentPath": { "type": "string", "required": true }
  },
  "state": {
    "theme": { "type": "string", "initial": "dark" }
  },
  "lifecycle": {
    "onMount": "loadTheme"
  },
  "actions": [
    {
      "name": "loadTheme",
      "steps": [
        {
          "do": "storage",
          "operation": "get",
          "key": { "expr": "lit", "value": "theme" },
          "storage": "local",
          "result": "savedTheme",
          "onSuccess": [
            {
              "do": "if",
              "condition": { "expr": "var", "name": "savedTheme" },
              "then": [
                {
                  "do": "set",
                  "target": "theme",
                  "value": { "expr": "var", "name": "savedTheme" }
                },
                {
                  "do": "dom",
                  "operation": "removeClass",
                  "selector": { "expr": "lit", "value": "html" },
                  "value": {
                    "expr": "cond",
                    "if": { "expr": "bin", "op": "==", "left": { "expr": "var", "name": "savedTheme" }, "right": { "expr": "lit", "value": "dark" } },
                    "then": { "expr": "lit", "value": "light" },
                    "else": { "expr": "lit", "value": "dark" }
                  }
                },
                {
                  "do": "dom",
                  "operation": "addClass",
                  "selector": { "expr": "lit", "value": "html" },
                  "value": { "expr": "var", "name": "savedTheme" }
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "toggleTheme",
      "steps": [
        {
          "do": "set",
          "target": "theme",
          "value": {
            "expr": "cond",
            "if": { "expr": "bin", "op": "==", "left": { "expr": "state", "name": "theme" }, "right": { "expr": "lit", "value": "dark" } },
            "then": { "expr": "lit", "value": "light" },
            "else": { "expr": "lit", "value": "dark" }
          }
        },
        {
          "do": "storage",
          "operation": "set",
          "key": { "expr": "lit", "value": "theme" },
          "value": { "expr": "state", "name": "theme" },
          "storage": "local"
        },
        {
          "do": "dom",
          "operation": "removeClass",
          "selector": { "expr": "lit", "value": "html" },
          "value": {
            "expr": "cond",
            "if": { "expr": "bin", "op": "==", "left": { "expr": "state", "name": "theme" }, "right": { "expr": "lit", "value": "dark" } },
            "then": { "expr": "lit", "value": "light" },
            "else": { "expr": "lit", "value": "dark" }
          }
        },
        {
          "do": "dom",
          "operation": "addClass",
          "selector": { "expr": "lit", "value": "html" },
          "value": { "expr": "state", "name": "theme" }
        }
      ]
    }
  ],
  "view": {
    "kind": "element",
    "tag": "div",
    "props": {
      "class": { "expr": "lit", "value": "min-h-screen bg-background" }
    },
    "children": [
      {
        "kind": "element",
        "tag": "header",
        "props": {
          "class": { "expr": "lit", "value": "fixed top-0 left-0 right-0 z-40 h-[var(--header-height)] border-b border-transparent bg-background" }
        },
        "children": [
          {
            "kind": "element",
            "tag": "div",
            "props": {
              "class": { "expr": "lit", "value": "mx-auto flex h-full max-w-7xl items-center justify-between px-6" }
            },
            "children": [
              {
                "kind": "element",
                "tag": "div",
                "props": {
                  "class": { "expr": "lit", "value": "flex items-center gap-4" }
                },
                "children": [
                  {
                    "kind": "element",
                    "tag": "a",
                    "props": {
                      "href": { "expr": "lit", "value": "/" },
                      "class": { "expr": "lit", "value": "text-xl font-bold text-foreground" }
                    },
                    "children": [
                      { "kind": "text", "value": { "expr": "lit", "value": "Constela" } }
                    ]
                  },
                  {
                    "kind": "element",
                    "tag": "nav",
                    "props": {
                      "class": { "expr": "lit", "value": "hidden items-center gap-6 md:flex" }
                    },
                    "children": [
                      {
                        "kind": "each",
                        "items": { "expr": "import", "name": "nav", "path": "topNav" },
                        "as": "item",
                        "body": {
                          "kind": "element",
                          "tag": "a",
                          "props": {
                            "href": { "expr": "var", "name": "item", "path": "href" },
                            "class": { "expr": "lit", "value": "text-sm transition-colors text-muted-foreground hover:text-foreground" }
                          },
                          "children": [
                            { "kind": "text", "value": { "expr": "var", "name": "item", "path": "title" } }
                          ]
                        }
                      }
                    ]
                  }
                ]
              },
              {
                "kind": "element",
                "tag": "div",
                "props": {
                  "class": { "expr": "lit", "value": "flex items-center gap-3" }
                },
                "children": [
                  {
                    "kind": "element",
                    "tag": "a",
                    "props": {
                      "href": { "expr": "import", "name": "config", "path": "repoMain" },
                      "target": { "expr": "lit", "value": "_blank" },
                      "rel": { "expr": "lit", "value": "noopener noreferrer" },
                      "class": { "expr": "lit", "value": "flex h-9 w-9 items-center justify-center rounded-md border border-border transition-colors hover:bg-muted" },
                      "aria-label": { "expr": "lit", "value": "GitHub repository" }
                    },
                    "children": [
                      {
                        "kind": "element",
                        "tag": "svg",
                        "props": {
                          "xmlns": { "expr": "lit", "value": "http://www.w3.org/2000/svg" },
                          "viewBox": { "expr": "lit", "value": "0 0 24 24" },
                          "fill": { "expr": "lit", "value": "currentColor" },
                          "class": { "expr": "lit", "value": "h-5 w-5" }
                        },
                        "children": [
                          {
                            "kind": "element",
                            "tag": "path",
                            "props": {
                              "d": { "expr": "lit", "value": "M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" }
                            }
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "kind": "element",
                    "tag": "button",
                    "props": {
                      "class": { "expr": "lit", "value": "flex h-9 w-9 items-center justify-center rounded-md border border-border transition-colors hover:bg-muted" },
                      "aria-label": { "expr": "lit", "value": "Toggle theme" },
                      "onClick": { "event": "click", "action": "toggleTheme" }
                    },
                    "children": [
                      {
                        "kind": "element",
                        "tag": "svg",
                        "props": {
                          "xmlns": { "expr": "lit", "value": "http://www.w3.org/2000/svg" },
                          "viewBox": { "expr": "lit", "value": "0 0 24 24" },
                          "fill": { "expr": "lit", "value": "none" },
                          "stroke": { "expr": "lit", "value": "currentColor" },
                          "stroke-width": { "expr": "lit", "value": "2" },
                          "class": { "expr": "lit", "value": "h-5 w-5" }
                        },
                        "children": [
                          { "kind": "element", "tag": "circle", "props": { "cx": { "expr": "lit", "value": "12" }, "cy": { "expr": "lit", "value": "12" }, "r": { "expr": "lit", "value": "5" } } },
                          { "kind": "element", "tag": "path", "props": { "d": { "expr": "lit", "value": "M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" } } }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "kind": "element",
        "tag": "aside",
        "props": {
          "class": { "expr": "lit", "value": "fixed left-0 top-[var(--header-height)] hidden h-[calc(100vh-var(--header-height))] w-[var(--sidebar-width)] overflow-y-auto border-r border-border bg-background p-6 lg:block" }
        },
        "children": [
          {
            "kind": "element",
            "tag": "nav",
            "props": {
              "class": { "expr": "lit", "value": "space-y-6" }
            },
            "children": [
              {
                "kind": "each",
                "items": { "expr": "param", "name": "navigation" },
                "as": "section",
                "body": {
                  "kind": "element",
                  "tag": "div",
                  "children": [
                    {
                      "kind": "element",
                      "tag": "h3",
                      "props": {
                        "class": { "expr": "lit", "value": "mb-2 text-sm font-semibold text-foreground" }
                      },
                      "children": [
                        { "kind": "text", "value": { "expr": "var", "name": "section", "path": "title" } }
                      ]
                    },
                    {
                      "kind": "element",
                      "tag": "ul",
                      "props": {
                        "class": { "expr": "lit", "value": "space-y-1" }
                      },
                      "children": [
                        {
                          "kind": "each",
                          "items": { "expr": "var", "name": "section", "path": "items" },
                          "as": "item",
                          "body": {
                            "kind": "element",
                            "tag": "li",
                            "children": [
                              {
                                "kind": "element",
                                "tag": "a",
                                "props": {
                                  "href": { "expr": "var", "name": "item", "path": "href" },
                                  "class": {
                                    "expr": "cond",
                                    "if": { "expr": "bin", "op": "==", "left": { "expr": "param", "name": "currentPath" }, "right": { "expr": "var", "name": "item", "path": "href" } },
                                    "then": { "expr": "lit", "value": "block rounded-md px-3 py-2 text-sm transition-colors bg-primary/10 font-medium text-primary" },
                                    "else": { "expr": "lit", "value": "block rounded-md px-3 py-2 text-sm transition-colors text-muted-foreground hover:bg-muted hover:text-foreground" }
                                  }
                                },
                                "children": [
                                  { "kind": "text", "value": { "expr": "var", "name": "item", "path": "title" } }
                                ]
                              }
                            ]
                          }
                        }
                      ]
                    }
                  ]
                }
              }
            ]
          }
        ]
      },
      {
        "kind": "element",
        "tag": "main",
        "props": {
          "class": { "expr": "lit", "value": "pt-[var(--header-height)] lg:pl-[var(--sidebar-width)]" }
        },
        "children": [
          { "kind": "slot" }
        ]
      },
      {
        "kind": "element",
        "tag": "div",
        "props": {
          "class": { "expr": "lit", "value": "lg:pl-[var(--sidebar-width)]" }
        },
        "children": [
          {
            "kind": "element",
            "tag": "footer",
            "props": {
              "class": { "expr": "lit", "value": "border-t border-border bg-background" }
            },
            "children": [
              {
                "kind": "element",
                "tag": "div",
                "props": {
                  "class": { "expr": "lit", "value": "mx-auto max-w-7xl px-6 py-8" }
                },
                "children": [
                  {
                    "kind": "element",
                    "tag": "div",
                    "props": {
                      "class": { "expr": "lit", "value": "grid items-center gap-4 text-center sm:grid-cols-3 sm:text-left" }
                    },
                    "children": [
                      {
                        "kind": "element",
                        "tag": "p",
                        "props": {
                          "class": { "expr": "lit", "value": "text-sm text-muted-foreground" }
                        },
                        "children": [
                          { "kind": "text", "value": { "expr": "lit", "value": "Â© 2025 Constela. All rights reserved." } }
                        ]
                      },
                      {
                        "kind": "element",
                        "tag": "span",
                        "props": {
                          "class": { "expr": "lit", "value": "text-xs text-muted-foreground sm:justify-self-center" }
                        },
                        "children": [
                          { "kind": "text", "value": { "expr": "lit", "value": "Built with Constela" } }
                        ]
                      },
                      {
                        "kind": "element",
                        "tag": "div",
                        "props": {
                          "class": { "expr": "lit", "value": "flex items-center justify-center gap-6 sm:justify-self-end" }
                        },
                        "children": [
                          {
                            "kind": "element",
                            "tag": "a",
                            "props": {
                              "href": { "expr": "import", "name": "config", "path": "repoMain" },
                              "target": { "expr": "lit", "value": "_blank" },
                              "rel": { "expr": "lit", "value": "noopener noreferrer" },
                              "class": { "expr": "lit", "value": "text-sm text-muted-foreground transition-colors hover:text-foreground" }
                            },
                            "children": [
                              { "kind": "text", "value": { "expr": "lit", "value": "GitHub" } }
                            ]
                          },
                          {
                            "kind": "element",
                            "tag": "a",
                            "props": {
                              "href": { "expr": "import", "name": "config", "path": "repoDocs" },
                              "target": { "expr": "lit", "value": "_blank" },
                              "rel": { "expr": "lit", "value": "noopener noreferrer" },
                              "class": { "expr": "lit", "value": "text-sm text-muted-foreground transition-colors hover:text-foreground" }
                            },
                            "children": [
                              { "kind": "text", "value": { "expr": "lit", "value": "Documentation" } }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}
